var loadGoogleAPI=function(e,t){window.simpleMapsLoadingGoogle=!0;var n=document.createElement("script");n.type="text/javascript",n.src="https://www.google.com/jsapi?key="+e,n.onreadystatechange=function(){loadMapsApi(e,t)},n.onload=function(){loadMapsApi(e,t)},document.body.appendChild(n)},loadMapsApi=function(e,t){google.load("maps","3",{other_params:["libraries=places","key="+e,"language="+t.replace("_","-"),"region="+t].join("&"),callback:function(){document.dispatchEvent(new Event("SimpleMapsGAPILoaded"))}})},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),SimpleMapSettings=function(){function e(t,n,s,a){var o=this;classCallCheck(this,e),this.namespacedId=null,this.mapSettings={lat:51.272154,lng:.514951,zoom:15,height:400,boundary:{nw:{lat:0,lng:0},se:{lat:0,lng:0}}},this.setup=!1,this.inputs=null,this.settingsMap=null,this.settingsMapEl=null,this.settingsMapWrap=null,this.boundaryMap=null,this.mouseMoveLastPos=0,this.nextHeight=0,this.onHideMapToggle=function(e){var t=!!e.target.getElementsByTagName("input")[0].value;if(t){var n=o.settingsMapWrap.getBoundingClientRect().height+"px";0!==n&&(o.settingsMapWrap.style.maxHeight=n)}setTimeout(function(){o.settingsMapWrap.classList[t?"add":"remove"]("hide")},1)},this.onSettingsMapReposition=function(){o.inputs.lng.value=o.settingsMap.center.lng(),o.inputs.lat.value=o.settingsMap.center.lat()},this.onSettingsMapZoom=function(){o.inputs.zoom.value=o.settingsMap.getZoom()},this.onResizeMouseDown=function(e){e.preventDefault(),o.mouseMoveLastPos=e.clientY,o.nextHeight=o.mapSettings.height,o.settingsMapEl.style.pointerEvents="none",o.settingsMapWrap.style.maxHeight="",document.addEventListener("mousemove",o.onResizeMouseMove),document.addEventListener("mouseup",o.onResizeMouseUp)},this.onResizeMouseMove=function(e){o.nextHeight=o.nextHeight+(e.clientY-o.mouseMoveLastPos),o.mouseMoveLastPos=e.clientY,o.nextHeight<250||requestAnimationFrame(function(){o.mapSettings.height=o.nextHeight,o.inputs.height.value=o.nextHeight,o.settingsMapEl.style.height=o.nextHeight+"px";var e=o.settingsMap.getCenter();google.maps.event.trigger(o.settingsMap,"resize"),o.settingsMap.setCenter(e)})},this.onResizeMouseUp=function(){o.settingsMapEl.style.pointerEvents="",document.removeEventListener("mousemove",o.onResizeMouseMove),document.removeEventListener("mouseup",o.onResizeMouseUp)},this.namespacedId=s,this.mapSettings=Object.keys(a).reduce(function(e,t){return e[t]=+a[t],e},{}),this.inputs={lat:document.getElementById(this.namespacedId+"lat"),lng:document.getElementById(this.namespacedId+"lng"),zoom:document.getElementById(this.namespacedId+"zoom"),height:document.getElementById(this.namespacedId+"height")},"undefined"==typeof google?window.simpleMapsLoadingGoogle||loadGoogleAPI(t,n):google.maps&&google.maps.places?this.setup||this.setupMaps():window.simpleMapsLoadingGoogle||loadMapsApi(t,n),document.addEventListener("SimpleMapsGAPILoaded",function(){o.setup||o.setupMaps()}),document.getElementById("type").addEventListener("change",function(e){"ether\\simplemap\\fields\\MapField"===e.target.value&&o.redrawMaps()}),$("#"+this.namespacedId+"hideMap").on("change",this.onHideMapToggle)}return createClass(e,[{key:"setupMaps",value:function(){this.setup=!0,this.settingsMapEl=document.getElementById(this.namespacedId+"settingsMap"),this.settingsMapWrap=document.getElementById(this.namespacedId+"settingsMapWrap"),this.settingsMap=new google.maps.Map(this.settingsMapEl,{zoom:this.mapSettings.zoom,center:new google.maps.LatLng(this.mapSettings.lat,this.mapSettings.lng),scrollwheel:!1,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP}),google.maps.event.addListener(this.settingsMap,"dragend",this.onSettingsMapReposition),google.maps.event.addListener(this.settingsMap,"zoom_changed",this.onSettingsMapZoom),document.getElementById(this.namespacedId+"settingsMapHeight").addEventListener("mousedown",this.onResizeMouseDown);var e=document.getElementById(this.namespacedId+"boundaryMap");this.boundaryMap=new google.maps.Map(e,{zoom:this.mapSettings.zoom,center:new google.maps.LatLng(this.mapSettings.lat,this.mapSettings.lng),scrollwheel:!1,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP})}},{key:"redrawMaps",value:function(){var e=this,t=this.settingsMap.getZoom(),n=this.settingsMap.getCenter(),s=this.boundaryMap.getZoom(),a=this.boundaryMap.getCenter();setTimeout(function(){google.maps.event.trigger(e.settingsMap,"resize"),e.settingsMap.setZoom(t),e.settingsMap.setCenter(n),google.maps.event.trigger(e.boundaryMap,"resize"),e.boundaryMap.setZoom(s),e.boundaryMap.setCenter(a)},1)}}]),e}();window.SimpleMapSettings=SimpleMapSettings;
//# sourceMappingURL=SimpleMapSettings.min.js.map
